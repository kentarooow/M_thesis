\documentclass[../main]{subfiles}

\graphicspath{{../figures/}}

\begin{document}

\section{モデルの出力を用いた異常音源までの距離推定}
本研究では前節で述べたように，モデルが正常音のメルスペクトログラムを出力するように学習を行う．
このメルスペクトログラムと観測音のメルスペクトログラムを比較することで，異常音源までの距離を推定する．
以下では，まず短時間フーリエ変換によるパワースペクトルの算出方法を示し，次にメルフィルタバンクによる次元削減の手法について述べる．
また，この式を利用し，次の節では，メルスペクトログラムが距離の増加に応じてどのように変化するかを示す．

\subsection{メルスペクトログラムの計算}

\subsubsection{短時間フーリエ変換}

音響信号 $x(t)$ に対して，時間領域信号を短いフレーム(ウインドウ)に分割し，各フレームごとにフーリエ変換を行うことで，時間-周波数領域への変換を行う．各フレームを $x[n]$ として離散化し，フレーム長を $N$，ウインドウ関数を $w[n]$ とすると，フレーム $m$ におけるSTFTは以下のように定義される．

\[
X(m, k) = \sum_{n=0}^{N-1} x[mL + n] w[n] e^{-j \frac{2\pi k n}{N}}
\]

ここで，$m$ はフレームインデックス，$k$ は周波数ビンインデックス，$L$ はフレームシフト幅である．このSTFT係数 $X(m, k)$ からパワースペクトル $P(m, k)$ を求める．パワースペクトルはSTFT係数の絶対値二乗として定義できる．

\[
P(m, k) = |X(m, k)|^2
\]

\subsubsection{メルフィルタバンク}


得られたパワースペクトル $P(m, k)$ を人間の聴覚特性に近いメル尺度(Mel scale)へとマッピングするために，メルフィルタバンクを適用する．メル尺度は対数的な周波数軸変換で定義され，周波数 $f$ [Hz] に対するメル周波数 $M(f)$ は，以下のように表される．

\[
M(f) = 2595 \log_{10}\left(1 + \frac{f}{700}\right)
\]

メルフィルタバンクは，メル尺度上で等間隔に配置された三角形状のフィルタを用い，パワースペクトルを加重和することでメルフィルタバンク出力を求める．フィルタ数を $M$ とすると，各メルフィルタ $H_{m'}(k)$ （$m' = 1, 2, \dots, M$）は周波数ビン $k$ に対応して重み付けを行う．

\[
S(m, m') = \sum_{k} P(m, k) H_{m'}(k)
\]

ここで，$S(m, m')$ はフレーム $m$ におけるメルフィルタバンク出力を示す．このメルフィルタバンク出力は，元々のパワースペクトルよりもはるかに低次元であるため，次元削減の効果を持つ．

一般的なメルスペクトログラム計算では対数変換を行うが，本研究では後述する距離推定特性を利用するために，対数変換を行わずに，$S(m, m')$ を特徴量として用いることを考える．この特徴量は周波数領域における音響強度をメル尺度上で集約したものである．



\subsection{メルスペクトログラムと距離の関係}

音源からの距離 $d$ に伴う音圧レベル(パワースペクトル強度)の減衰は，一般的な自由音場近似下では距離の2乗に反比例して減少する．これは，点音源から放射される音波が半径 $d$ の球面上で等方的に広がると考えると，エネルギー密度が半径に対して $1/d^2$ で減少するためである．

異常音源からの受信パワースペクトルを $P_d(m, k)$，基準距離1でのパワースペクトルを $P_0(m, k)$ とし，減衰係数を2とすると，以下の関係が成り立つ．

\[
P_d(m, k) = \frac{P_0(m, k)}{d^2}
\]

メルフィルタバンク出力 $S(m, m')$ はパワースペクトルをメルフィルタで集約したものであるため，各メルフィルタ帯域においても距離とともに強度が $1/d^2$ で減少する．すなわち，

\[
S_d(m, m') = \sum_{k} P_d(m, k) H_{m'}(k) = \sum_{k} \frac{P_0(m, k)}{d^2} H_{m'}(k) = \frac{1}{d^2} \sum_{k} P_0(m, k) H_{m'}(k)
\]

よって，メルフィルタバンク出力は，対数変換を施さない生の値 $S_d(m, m')$ を用いると，距離の2乗に反比例して減少することが示される．

この特性を用いることで，観測されたメルフィルタバンク出力とモデルが正常音状態から推定したメルフィルタバンク出力を比較し，異常音の増加による強度変化や空間的分布を解析することで，異常音源までの距離を推定することが可能となる．
\label{sec:pmethod_preprocessing}

\end{document}

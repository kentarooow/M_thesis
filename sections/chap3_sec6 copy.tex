\documentclass[../main]{subfiles}

\graphicspath{{../figures/}}

\begin{document}

\section{出力による異常音源までの距離推定}
\label{sec:pmethod_anomaly_detection}

\section{異常音の検}
正常音のデータによってモデルを学習した後，実際の運用が始まる．
ロボットは環境を巡回する際に，マイクロフォンを用いて音響データが対応する自己位置座標と同時に，記録される．
前節で説明した同様の前処理が音響データに適用され，観測された環境のメルスペクトログラムのセットが得られる．
これをロボットの位置 $\mathbf{x}_i$ に対応する $m_i^o$ とする。
一方で、位置情報は正常データで訓練されたニューラルネットワークに入力され、ロボット位置 $\mathbf{x}_i$ に対して予測された音 $m_i^p$ が得られる。

最後に、観測されたMelスペクトログラムと予測されたMelスペクトログラムの比較が $L_1$ ノルムを使用して行われ、エネルギー差が算出される。これは式 (1) のように表され、異常検知の閾値を $T_h$ とする。

\begin{equation}
    E_i = L_1(m_i^o, m_i^p) < T_h \quad (1)
\end{equation}

予測を生成したモデルは正常データのみを用いて訓練されているため、その予測は環境の正常な状態に対応する。観測された音が予測から逸脱した場合、それは異常音とみなされ、異常音が検出されたロボット位置とその対応するエネルギー差からなる集合
\[
S = \{ (\mathbf{x}_i^*, E_i^*) \}
\]
が得られる。

\label{sec:pmethod_preprocessing}


式 (1) の左辺は観測された音と予測された音のエネルギー差に対応する。

音波が運ぶエネルギーは距離の平方根に反比例して減衰することが知られている。すなわち、距離の二乗に反比例する。これは式 (2) で表される。ここで、$E$ は波が運ぶエネルギー、$r$ は観測点と音源との距離である。

\begin{equation}
    E \propto \frac{\alpha}{r^2} \tag{2}
\end{equation}

異常音源の位置 $\mathbf{x}_a$ を定数とし、座標系における適切な距離関数を $d(., .)$ とすると、式 (2) は集合 $S$ のサンプルに対して式 (3) に書き換えられる。

\begin{equation}
    d(\mathbf{x}_a, \mathbf{x}_i^*) = \frac{\alpha}{\sqrt{E_i^*}} \tag{3}
\end{equation}

これが集合 $S$ 内のすべてのサンプルに対して成り立つため、式 (4) を導ける。

\begin{equation}
    \sum_{S} \left| d(\mathbf{x}_a, \mathbf{x}_i^*) - \frac{\alpha}{\sqrt{E_i^*}} \right| = 0 \tag{4}
\end{equation}

ここで、環境内に単一の異常音源のみが存在し、$\alpha$ が環境に依存する定数であると仮定すると、異常音源の位置を求めることが可能になる。

\end{document}
